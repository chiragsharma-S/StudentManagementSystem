{% extends "base.html" %}
{% block content %}

<div class="card card-soft">
  <div class="card-body">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="page-title mb-0">Students</h2>
        <div class="d-flex">
            <form class="d-flex me-2" method="get" action="{{ url_for('students') }}">
                <input type="text"
                       name="q"
                       class="form-control form-control-sm"
                       placeholder="Search by roll, name, course"
                       value="{{ q or '' }}">
                <button class="btn btn-sm btn-outline-secondary ms-2 btn-rounded" type="submit">Search</button>
            </form>
            <a href="{{ url_for('add_student') }}" class="btn btn-primary btn-rounded">Add Student</a>
        </div>
    </div>

    {% if q %}
    <p class="text-muted">Showing results for: <strong>{{ q }}</strong></p>
    {% endif %}

    {% if students|length == 0 %}
        <p>No students added yet. Click “Add Student” to create one.</p>
    {% else %}
    <div class="table-responsive">
      <table class="table table-striped table-bordered align-middle mb-0">
          <thead>
          <tr>
              <th>ID</th>
              <th>Roll No</th>
              <th>Name</th>
              <th>Course</th>
              <th>Semester</th>
              <th>Phone</th>
              <th style="width: 230px;">Actions</th>
          </tr>
          </thead>
          <tbody>
          {% for s in students %}
              <tr>
                  <td>{{ s.id }}</td>
                  <td>{{ s.roll_no }}</td>
                  <td>{{ s.name }}</td>
                  <td>{{ s.course }}</td>
                  <td>{{ s.semester }}</td>
                  <td>{{ s.phone }}</td>
                  <td>
                      <a href="{{ url_for('edit_student', id=s.id) }}" class="btn btn-sm btn-warning btn-rounded">Edit</a>
                      <a href="{{ url_for('student_attendance', id=s.id) }}" class="btn btn-sm btn-info btn-rounded">View Attendance</a>
                      <form action="{{ url_for('delete_student', id=s.id) }}" method="post" style="display:inline;">
                          <button class="btn btn-sm btn-danger btn-rounded"
                                  onclick="return confirm('Delete this student?');">
                              Delete
                          </button>
                      </form>
                  </td>
              </tr>
          {% endfor %}
          </tbody>
      </table>
    </div>
    {% endif %}

  </div>
</div>

{% endblock %}
